<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>GX71 アクセル</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:black;
  color:white;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#wrap{text-align:center;}
#pedal{
  width:220px;
  height:220px;
  border-radius:50%;
  background:#c00;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:22px;
  user-select:none;
}
#rpm{margin-top:20px;opacity:0.8;}
</style>
</head>
<body>

<div id="wrap">
  <h1>GX71 マークII</h1>
  <div id="pedal">ACCEL</div>
  <div id="rpm">RPM: 800</div>
</div>

<audio id="engine" src="sounds/video-output-E1E478D7-8EF9-4800-9467-5685FCF4DD36.mp3"></audio>

<script>
const engine = document.getElementById("engine");
const pedal = document.getElementById("pedal");
const rpmText = document.getElementById("rpm");

let rpm = 800;
let accelOn = false;
let started = false;

// 押した瞬間：必ず音を開始
function press(){
  accelOn = true;

  if(!started){
    engine.currentTime = 0;
    engine.playbackRate = 1.0;
    engine.volume = 1.0;
    engine.play();
    started = true;
  }
}

// 離したら減速
function release(){
  accelOn = false;
}

pedal.addEventListener("touchstart", press);
pedal.addEventListener("mousedown", press);
pedal.addEventListener("touchend", release);
pedal.addEventListener("mouseup", release);

// 回転制御（実車寄せ）
setInterval(()=>{
  if(accelOn){
    // 加速：重く、じわっと上がる
    rpm += 90;
    if(rpm > 4800) rpm = 4800;
  }else{
    // 減速：自然に落ちる
    rpm -= 140;
    if(rpm < 800) rpm = 800;
  }

  // 音の高さに反映
  engine.playbackRate = 0.7 + (rpm / 6000);

  rpmText.textContent = "RPM: " + rpm;
}, 60);
</script>

</body>
</html>
