<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>GX71 アクセル</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:black;
  color:white;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#wrap{text-align:center;}
#pedal{
  width:200px;
  height:200px;
  border-radius:50%;
  background:#c00;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:22px;
  user-select:none;
}
#rpm{margin-top:20px;opacity:0.7;}
</style>
</head>
<body>

<div id="wrap">
  <h1>GX71 マークII</h1>
  <div id="pedal">ACCEL</div>
  <div id="rpm">RPM: 800</div>
</div>

<audio id="engine" src="sounds/video-output-E1E478D7-8EF9-4800-9467-5685FCF4DD36.mp3" loop></audio>

<script>
const engine = document.getElementById("engine");
const pedal = document.getElementById("pedal");
const rpmText = document.getElementById("rpm");

let rpm = 800;
let target = 800;
let playing = false;

// 押したら加速
function accel(){
  target = 4500;
  if(!playing){
    engine.currentTime = 0;
    engine.playbackRate = 0.8;
    engine.volume = 1.0;
    engine.play();
    playing = true;
  }
}

// 離したら減速
function release(){
  target = 800;
}

pedal.addEventListener("touchstart", accel);
pedal.addEventListener("mousedown", accel);
pedal.addEventListener("touchend", release);
pedal.addEventListener("mouseup", release);

// 回転数変化ループ
setInterval(()=>{
  rpm += (target - rpm) * 0.08;

  // ピッチ変換（ここが肝）
  engine.playbackRate = 0.6 + (rpm / 6000);

  rpmText.textContent = "RPM: " + Math.floor(rpm);
}, 30);
</script>

</body>
</html>
