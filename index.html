<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æ—§è»Š ç©ºã¶ã‹ã—</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#ui{
  text-align:center;
}
button{
  font-size:24px;
  padding:20px 40px;
  background:#c00;
  color:#fff;
  border:none;
  border-radius:10px;
}
p{
  margin-top:20px;
  color:#aaa;
}
</style>
</head>
<body>

<div id="ui">
  <h1>GX71 ãƒãƒ¼ã‚¯II</h1>
  <button id="rev">ç©ºã¶ã‹ã—ğŸ”¥</button>
  <p>ç›´ç®¡ãƒãƒ•ãƒ©ãƒ¼ / çˆ†éŸ³æ³¨æ„</p>
</div>

<script>
let audioCtx;
let osc;
let gain;
let noise;
let noiseGain;

function startEngine(){
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();

  osc = audioCtx.createOscillator();
  osc.type = "sawtooth";
  osc.frequency.value = 80;

  gain = audioCtx.createGain();
  gain.gain.value = 0;

  noise = audioCtx.createBufferSource();
  const buffer = audioCtx.createBuffer(1, audioCtx.sampleRate, audioCtx.sampleRate);
  const data = buffer.getChannelData(0);
  for(let i=0;i<data.length;i++){
    data[i] = (Math.random()*2-1)*0.6;
  }
  noise.buffer = buffer;
  noise.loop = true;

  noiseGain = audioCtx.createGain();
  noiseGain.gain.value = 0;

  osc.connect(gain).connect(audioCtx.destination);
  noise.connect(noiseGain).connect(audioCtx.destination);

  osc.start();
  noise.start();
}

function rev(){
  if(!audioCtx){
    startEngine();
  }

  osc.frequency.linearRampToValueAtTime(320, audioCtx.currentTime + 0.1);
  osc.frequency.linearRampToValueAtTime(120, audioCtx.currentTime + 0.6);

  gain.gain.linearRampToValueAtTime(0.8, audioCtx.currentTime + 0.05);
  gain.gain.linearRampToValueAtTime(0.2, audioCtx.currentTime + 0.6);

  noiseGain.gain.linearRampToValueAtTime(0.7, audioCtx.currentTime + 0.1);
  noiseGain.gain.linearRampToValueAtTime(0.1, audioCtx.currentTime + 0.6);
}

document.getElementById("rev").addEventListener("touchstart", rev);
document.getElementById("rev").addEventListener("mousedown", rev);
</script>

</body>
</html>
