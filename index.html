<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>GX71 音テスト</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:black;
  color:white;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
button{
  font-size:28px;
  padding:30px 60px;
  background:#c00;
  color:white;
  border:none;
  border-radius:16px;
}
</style>
</head>
<body>

<button id="btn">▶ エンジンON</button>

<audio id="audio" preload="auto">
  <source src="sounds/video-output-E1E478D7-8EF9-4800-9467-5685FCF4DD36.mp3" type="audio/mpeg">
</audio>

<script>
const btn = document.getElementById("btn");
const audio = document.getElementById("audio");

let ctx;
let source;
let gain;

btn.addEventListener("touchstart", start, {once:true});
btn.addEventListener("mousedown", start, {once:true});

function start(){
  // ① AudioContextを「タップ中」に生成
  ctx = new (window.AudioContext || window.webkitAudioContext)();

  // ② 明示的に resume（これが超重要）
  ctx.resume();

  // ③ audio を WebAudio に接続
  source = ctx.createMediaElementSource(audio);
  gain = ctx.createGain();
  gain.gain.value = 1.0;

  source.connect(gain);
  gain.connect(ctx.destination);

  // ④ 再生
  audio.currentTime = 0;
  audio.play();
}
</script>

</body>
</html>
